



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Enterprise productivity solutions">
      
      
        <link rel="canonical" href="https://docs.kudosapps.com/swarm/setup/">
      
      
        <meta name="author" content="Jay Agrawal">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.3.0">
    
    
      
        <title>Docker Swarm - Kudos Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.572ca0f0.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#fb8c00">
      
    
    
      <script src="../../assets/javascripts/modernizr.962652e9.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../assets/css/custom.css">
    
    
      
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1747668-5"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-1747668-5")</script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="orange" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#overview-introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.kudosapps.com" title="Kudos Docs" class="md-header-nav__button md-logo">
          
            <i class="md-icon">local_library</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Kudos Docs
              </span>
              <span class="md-header-nav__topic">
                Docker Swarm
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://www.kudosapps.com" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      kudosapps.com
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.kudosapps.com" title="Kudos Docs" class="md-nav__button md-logo">
      
        <i class="md-icon">local_library</i>
      
    </a>
    Kudos Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://www.kudosapps.com" title="Go to repository" class="md-source" data-md-source="">
    
    <div class="md-source__repository">
      kudosapps.com
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Welcome" class="md-nav__link">
      Welcome
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Kudos Boards
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Kudos Boards
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../boards/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Installation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../boards/icp/" title="IBM ICP (Kubernetes)" class="md-nav__link">
      IBM ICP (Kubernetes)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boards/swarm/" title="Docker Swarm" class="md-nav__link">
      Docker Swarm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boards/websphere/" title="Websphere" class="md-nav__link">
      Websphere
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boards/wasconfig/" title="WAS Config" class="md-nav__link">
      WAS Config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../boards/widgets/" title="Connections Widgets" class="md-nav__link">
      Connections Widgets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../ideas/" title="Kudos Ideas" class="md-nav__link">
      Kudos Ideas
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Docker Swarm
      </label>
    
    <a href="./" title="Docker Swarm" class="md-nav__link md-nav__link--active">
      Docker Swarm
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview-introduction" title="Overview / Introduction" class="md-nav__link">
    Overview / Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-information" title="Server information" class="md-nav__link">
    Server information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-setup" title="Network setup" class="md-nav__link">
    Network setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-ansible" title="Setup Ansible" class="md-nav__link">
    Setup Ansible
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-access" title="Server access" class="md-nav__link">
    Server access
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#config" title="Config" class="md-nav__link">
    Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy" title="Deploy" class="md-nav__link">
    Deploy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-dns-records" title="Update DNS records" class="md-nav__link">
    Update DNS records
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portainer-setup" title="Portainer Setup" class="md-nav__link">
    Portainer Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-kudos-boards-and-other-apps-with-portainer" title="Run Kudos Boards (and other apps) with Portainer" class="md-nav__link">
    Run Kudos Boards (and other apps) with Portainer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-logging-and-monitoring" title="Advanced (logging and monitoring)" class="md-nav__link">
    Advanced (logging and monitoring)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recover-from-cluster-crash" title="Recover from Cluster crash" class="md-nav__link">
    Recover from Cluster crash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recover-from-service-crash" title="Recover from Service crash" class="md-nav__link">
    Recover from Service crash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rebalance-containers-on-nodes" title="Rebalance containers on Nodes" class="md-nav__link">
    Rebalance containers on Nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview-introduction" title="Overview / Introduction" class="md-nav__link">
    Overview / Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-information" title="Server information" class="md-nav__link">
    Server information
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#network-setup" title="Network setup" class="md-nav__link">
    Network setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-ansible" title="Setup Ansible" class="md-nav__link">
    Setup Ansible
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#server-access" title="Server access" class="md-nav__link">
    Server access
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#config" title="Config" class="md-nav__link">
    Config
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy" title="Deploy" class="md-nav__link">
    Deploy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#update-dns-records" title="Update DNS records" class="md-nav__link">
    Update DNS records
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portainer-setup" title="Portainer Setup" class="md-nav__link">
    Portainer Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-kudos-boards-and-other-apps-with-portainer" title="Run Kudos Boards (and other apps) with Portainer" class="md-nav__link">
    Run Kudos Boards (and other apps) with Portainer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-logging-and-monitoring" title="Advanced (logging and monitoring)" class="md-nav__link">
    Advanced (logging and monitoring)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" title="Troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recover-from-cluster-crash" title="Recover from Cluster crash" class="md-nav__link">
    Recover from Cluster crash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recover-from-service-crash" title="Recover from Service crash" class="md-nav__link">
    Recover from Service crash
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rebalance-containers-on-nodes" title="Rebalance containers on Nodes" class="md-nav__link">
    Rebalance containers on Nodes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Docker Swarm</h1>
                
                <h2 id="overview-introduction">Overview / Introduction<a class="headerlink" href="#overview-introduction" title="Permanent link">&para;</a></h2>
<p>While there are many ways to setup a docker swarm environment, this document will step through setting up a functional environment that includes:</p>
<ul>
<li>Shared storage with nfs</li>
<li>http(s) proxy <em>traefik</em></li>
<li>Database <em>mongo</em></li>
<li>File storage <em>minio</em></li>
<li>Management interface <em>portainer</em></li>
<li>Logging <em>elk stack</em> - (optional)</li>
<li>Monitoring <em>prometheus/grafana</em> - (optional)</li>
</ul>
<hr />
<h2 id="server-information">Server information<a class="headerlink" href="#server-information" title="Permanent link">&para;</a></h2>
<p>As the name swarm suggests, this setup is designed to run across a number of servers (referred to as nodes). ISW recommends that the minimum number of servers you should start with is 4, being one for the NFS server and http gateway and 3 swarm managers. You may start with small VMs to set this up and expand them as your need increases (either by extending cores and ram on the existing servers or by adding more manager/worker nodes to your swarm).</p>
<p>This document will assume the following setup:</p>
<ul>
<li>Gateway server (CentOS)</li>
<li>3 Swarm managers (CoreOS)</li>
</ul>
<p>If you have more managers or workers just extend the config where indicated below.</p>
<p>If you are testing this setup, you can get away with quite small servers (we have had success with 2 cores and 1.7gb ram) however if you plan to include the logging and/or monitoring services then you should expect to dedicate an additional 2gb ram minimum for each of these sevices.</p>
<hr />
<h2 id="network-setup">Network setup<a class="headerlink" href="#network-setup" title="Permanent link">&para;</a></h2>
<p>The setup below will establish some internal networking rules to help protect your environment.<br />
When configuring the servers, you will need to enable the following network rules:</p>
<ul>
<li>http(s) traffic should be allowed to the Gateway only</li>
<li>ssh traffic should be allowed to all servers</li>
<li>Where possible all servers should be on an additional (internal only) subnet, this allows us to further lock down access to NFS shares</li>
</ul>
<hr />
<h2 id="setup-ansible">Setup Ansible<a class="headerlink" href="#setup-ansible" title="Permanent link">&para;</a></h2>
<p>Throughout this guide we will use ansible to setup the servers and deploy services (stacks) to the swarm.</p>
<p>If you have access to a Mac or Linux machine, <a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html">follow these instructions</a> to get up and running.</p>
<p>Whilst that document states windows is not supported, ISW has had much success running ansible under windows by enabling WSL (Windows subsystem for Linux), installing Ubuntu for the windows store and proceeding with the Ubuntu instructions linked.</p>
<p>Refer to <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">this document from Microsoft</a> for more information on WSL and the windows store options.</p>
<p>TODO: they need access to our ansible setup!!!</p>
<hr />
<h2 id="server-access">Server access<a class="headerlink" href="#server-access" title="Permanent link">&para;</a></h2>
<p>Ansible uses ssh to communicate with the servers so you'll need to be able to access them from your shell directly.</p>
<p>The ideal way to achieve this is to setup key based authentication, however there are workarounds that can be done if you have to use password based authentication.</p>
<p>For more info on setting up an ssh private key, see <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-ssh-keys--2">this tutorial</a></p>
<p>As mentioned in the linked article, we will need to add each of our servers to our local list of known hosts, this is done by manually connecting to each of them for our shell.</p>
<pre><code>ssh -i path/to/keyfile &lt;username&gt;@&lt;server_ip&gt;
e.g. ssh -i /home/nicky/.ssh/id_rsa nicky@10.10.10.1
</code></pre>
<hr />
<h2 id="config">Config<a class="headerlink" href="#config" title="Permanent link">&para;</a></h2>
<p>Download <a href="/assets/config/swarm.yml">this hosts file</a> and update the values as follows:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>all.hosts.gateway.ansible_host</td>
<td>IP For Gateway server accessible from your machine</td>
</tr>
<tr>
<td>all.hosts.nfs_server.ansible_host</td>
<td>IP For Gateway server accessible from your machine</td>
</tr>
<tr>
<td>all.hosts.nfs_server.internal_ip</td>
<td>internal IP For Gateway server, if you do not have an internal subnet, use the same IP as above</td>
</tr>
<tr>
<td>all.hosts.manager(1,2,3).ansible_host</td>
<td>IP For Manager node accessible from your machine</td>
</tr>
<tr>
<td>all.hosts.manager(1,2,3).internal_ip</td>
<td>internal IP For Manager node, if you do not have an internal subnet, use the same IP as above</td>
</tr>
<tr>
<td>all.vars.ansible_user</td>
<td>Your username on all servers</td>
</tr>
<tr>
<td>all.vars.ansible_ssh_private_key_file</td>
<td>Full path to your keyfile (leave blank if using password auth)</td>
</tr>
<tr>
<td>all.vars.swarm_ip_mask</td>
<td>ip mask that matches your internal subnet e.g. 10.10.10.10/24, or that matches all swarm nodes if you do not have an internal subnet</td>
</tr>
<tr>
<td>all.vars.ssl_certs</td>
<td>For ssl to work on your environment, you need to have a pem encoded certificate and keyfile for each domain you plan to serve on. You should name these files name.crt and name.key and then add all of the names in this field</td>
</tr>
<tr>
<td>all.vars.dashboard_host</td>
<td>The domain name for your portainer dashboard</td>
</tr>
<tr>
<td>all.vars.proxy_dashboard_host</td>
<td>The domain name for your traefik proxy dashboard</td>
</tr>
<tr>
<td>all.vars.monitoring</td>
<td>This section will be covered in Advanced below, you should get the swarm up and running first before adding monitoring</td>
</tr>
<tr>
<td>all.children</td>
<td>This section of the config file is for defining where your nodes will sit, please follow the instructions provided in the file itself, adding all nodes to the coreos group, and managers and workers to their respective groups</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="deploy">Deploy<a class="headerlink" href="#deploy" title="Permanent link">&para;</a></h2>
<ol>
<li>Save your config file in the hosts directory</li>
<li>run the deploy playbook:<pre><code>ansible-playbook -i hosts/swarm.yml deploy.yml -v
</code></pre>
</li>
</ol>
<hr />
<h2 id="update-dns-records">Update DNS records<a class="headerlink" href="#update-dns-records" title="Permanent link">&para;</a></h2>
<p>Ensure that DNS records for your portainer dashbaord and traefik dashboard as defined in your config file are pointing to your Gateway server</p>
<hr />
<h2 id="portainer-setup">Portainer Setup<a class="headerlink" href="#portainer-setup" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p>Open Dashboard as defined in <code>{{dashboard_host}}</code> above</p>
</li>
<li>
<p>Create admin user when prompted TODO: confirm this</p>
</li>
<li>
<p>Add Dockerhub auth</p>
<ul>
<li>Open Registries</li>
<li>Tick Authentication</li>
<li>add Username, Password</li>
</ul>
</li>
</ol>
<hr />
<h2 id="run-kudos-boards-and-other-apps-with-portainer">Run Kudos Boards (and other apps) with Portainer<a class="headerlink" href="#run-kudos-boards-and-other-apps-with-portainer" title="Permanent link">&para;</a></h2>
<p>See <a href="/boards/swarm/">Kudos Boards for Docker Swarm</a> for a step by step guide to running Kudos Boards on your new environment.</p>
<hr />
<h2 id="advanced-logging-and-monitoring">Advanced (logging and monitoring)<a class="headerlink" href="#advanced-logging-and-monitoring" title="Permanent link">&para;</a></h2>
<p>TODO</p>
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h4 id="recover-from-cluster-crash">Recover from Cluster crash<a class="headerlink" href="#recover-from-cluster-crash" title="Permanent link">&para;</a></h4>
<p>Start new cluster</p>
<pre><code>docker swarm init --force-new-cluster --advertise-addr 10.142.0.12:2377
</code></pre>
<p>Check other Nodes automatically join new cluster</p>
<pre><code>docker node ls
</code></pre>
<p>If they don't, use the join command provided, ie:</p>
<pre><code>docker swarm join --token SWMTKN-1-1korweqob1x2530nc34uex84j03pa1e3x7qg5z2pt4bvt2fo5i-0aoijiczvso7socyzlrucbu8y 10.142.0.12:2377
</code></pre>
<p>List 'Down' nodes</p>
<pre><code>docker node ls
</code></pre>
<p>Remove 'Down' nodes</p>
<pre><code>docker node demote &lt;node_id&gt;
docker node rm &lt;node_id&gt;
</code></pre>
<h4 id="recover-from-service-crash">Recover from Service crash<a class="headerlink" href="#recover-from-service-crash" title="Permanent link">&para;</a></h4>
<ul>
<li>Run deploy stacks again</li>
<li>Update each stack/service through Portainer</li>
</ul>
<h4 id="rebalance-containers-on-nodes">Rebalance containers on Nodes<a class="headerlink" href="#rebalance-containers-on-nodes" title="Permanent link">&para;</a></h4>
<pre><code>docker service update --force &lt;stack&gt;_&lt;service&gt;
</code></pre>
<p>ie:</p>
<pre><code>docker service update --force portainer_portainer proxy_proxy portainer_agent
</code></pre>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../ideas/" title="Kudos Ideas" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Kudos Ideas
              </span>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/isw-kudos" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/kudosbadges" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://www.linkedin.com/company/isw_2/about/" class="md-footer-social__link fa fa-linkedin"></a>
    
      <a href="https://www.youtube.com/channel/UC_9nMUcp6jcweQZML2qIy8A" class="md-footer-social__link fa fa-youtube"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.a353778b.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>